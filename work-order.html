<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°åŒºç‰©ä¸šåå°ç®¡ç†ç³»ç»Ÿ - å·¥å•ç®¡ç†</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Might not be needed, keep for now -->
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <h1>LOGO</h1>
            <p>å°åŒºç‰©ä¸šåå°ç®¡ç†</p>
        </div>
        <div class="menu">
             <a href="dashboard.html" class="menu-item">
                 <i>ğŸ“„</i> é¦–é¡µ
             </a>
             <a href="monitoring.html" class="menu-item">
                 <i>ğŸšª</i> é—¨ç¦ç›‘æ§
             </a>
             <a href="owner-management.html" class="menu-item">
                 <i>ğŸ¢</i> ä¸šä¸»ç®¡ç†
             </a>
             <a href="work-order.html" class="menu-item"> 
                 <i>ğŸ“</i> å·¥å•ç®¡ç†
             </a>
             <a href="visitor-management.html" class="menu-item">
                 <i>ğŸ‘¥</i> è®¿å®¢ç®¡ç†
             </a>
             <a href="appointment-management.html" class="menu-item">
                 <i>ğŸ“…</i> é¢„çº¦ç®¡ç†
             </a>
             <a href="parking-management.html" class="menu-item">
                 <i>ğŸ…¿ï¸</i> è½¦ä½ç®¡ç†
             </a>
        </div>
    </div>

    <div class="main-content">
        <!-- Content from original #work-order-view starts here -->
         <div class="module" style="position: relative;">
             <div class="table-loading-overlay" id="work-order-table-loading">
                 åŠ è½½ä¸­...
                </div>
             <div class="filter-bar">
                 <select name="workOrderType" id="workOrderType">
                     <option value="">å·¥å•ç±»å‹</option>
                     <option value="repair">æŠ¥ä¿®</option>
                     <option value="payment">ç¼´è´¹</option>
                 </select>
                 <select name="workOrderStatus" id="workOrderStatus">
                     <option value="">å·¥å•çŠ¶æ€</option>
                     <option value="pending">å¾…å¤„ç†</option>
                     <option value="processing">å¤„ç†ä¸­</option>
                     <option value="completed">å·²å®Œæˆ</option>
                     <option value="paid">å·²ç¼´è´¹</option> 
                     <option value="unpaid">å¾…ç¼´è´¹</option> 
                 </select>
                 <select name="priority" id="priority-select">
                     <option value="">ç´§æ€¥ç¨‹åº¦</option>
                     <option value="high">é«˜</option>
                     <option value="medium">ä¸­</option>
                     <option value="low">ä½</option>
                 </select>
                 <select name="repairArea" id="repair-area-select">
                     <option value="">ç»´ä¿®åŒºåŸŸ</option>
                     <!-- TODO: Populate with actual areas -->
                 </select>
                 <select name="feeType" id="fee-type-select" style="display: none;">
                     <option value="">ç¼´è´¹ç±»å‹</option>
                     <option value="water">æ°´ç”µè´¹</option>
                     <option value="property">ç‰©ä¸šè´¹</option>
                 </select>
                 <input type="date" name="workOrderDate">
                 <input type="text" name="workOrderSearch" placeholder="æ¨¡ç³ŠæŸ¥è¯¢ (å•å·/æè¿°)">
                 <button class="search-button">æŸ¥è¯¢</button>
                 <button class="reset-button" style="margin-left: 5px;">æ¸…ç©º</button> 
            </div>

             <div class="action-buttons">
                 <button class="primary-action">å¯¼å‡ºæ•°æ®</button>
                 <button class="secondary-action" id="refresh-work-order-table" style="margin-left: auto;">
                     <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"></path></svg>
                     åˆ·æ–°è¡¨æ ¼
                 </button>
             </div>

             <!-- ç»´ä¿®å·¥å•è¡¨æ ¼ -->
             <table class="work-order-table repair-table">
                 <thead>
                     <tr>
                         <th><input type="checkbox"></th>
                         <th>çŠ¶æ€</th>
                         <th>ç´§æ€¥ç¨‹åº¦</th>
                         <th>å•å·</th>
                         <th>ç»´ä¿®åŒºåŸŸ</th>
                         <th>æ•…éšœæè¿°</th>
                         <th>ä¸Šé—¨æ—¶é—´</th>
                         <th>è”ç³»æ–¹å¼</th>
                         <th>åˆ›å»ºæ—¶é—´</th>
                     </tr>
                 </thead>
                 <tbody>
                     <!-- Work order rows will be populated here -->
                     <tr><td colspan="9" style="text-align: center; padding: 20px;">åŠ è½½ä¸­...</td></tr>
                 </tbody>
             </table>

             <!-- ç¼´è´¹å·¥å•è¡¨æ ¼ -->
             <table class="work-order-table payment-table" style="display: none;">
                 <thead>
                     <tr>
                         <th><input type="checkbox"></th>
                         <th>çŠ¶æ€</th>
                         <th>ç±»å‹</th>
                         <th>å•å·</th>
                         <th>è´¹ç”¨æ˜ç»†</th>
                         <th>è®¡è´¹å‘¨æœŸ</th>
                         <th>åº”ç¼´é‡‘é¢</th>
                         <th>åˆ›å»ºæ—¶é—´</th>
                     </tr>
                 </thead>
                 <tbody>
                     <!-- Payment order rows will be populated here -->
                     <tr><td colspan="8" style="text-align: center; padding: 20px;">åŠ è½½ä¸­...</td></tr>
                 </tbody>
             </table>

             <div class="table-footer">
                 <div class="footer-actions">
                     <button class="primary-action" id="work-order-remind-button">æé†’</button>
                     <button class="delete-button" id="work-order-delete-button">åˆ é™¤</button>
                 </div>
                 <div class="pagination">
                     <span>æœ¬é¡µå…±Xæ¡/å…±XXXæ¡</span>
                     <a href="#">&lt;</a>
                     <!-- Page numbers -->
                     <span class="dots" style="display: none;">...</span>
                     <a href="#">&gt;</a>
                     <span>è·³è½¬è‡³</span>
                     <input type="number" min="1" value="1">
                     <span>é¡µ</span>
                     <button>è·³è½¬</button>
                 </div>
             </div>
            </div>
        <!-- Content from original #work-order-view ends here -->
    </div>

    <!-- Operation Success Modal (Copied for self-containment) -->
    <div id="success-modal" class="modal-overlay">
         <div class="modal" style="width: 350px;">
             <div class="success-modal-content">
                 <img src="images/æ“ä½œæˆåŠŸ.png" alt="æ“ä½œæˆåŠŸ">
                 <p>æ“ä½œæˆåŠŸ</p>
            </div>
        </div>
    </div>

    <!-- Change Work Order Status Modal -->
    <div id="change-work-order-status-modal" class="modal-overlay">
        <div class="modal" style="width: 400px;">
            <div class="modal-header">
                <h3>ä¿®æ”¹å·¥å•çŠ¶æ€</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>å·¥å•å•å·:</label>
                    <span id="modal-wo-id" class="value">N/A</span>
                </div>
                <div class="form-group">
                    <label>å½“å‰çŠ¶æ€:</label>
                    <span id="modal-wo-current-status" class="value">N/A</span>
                </div>
                 <div class="form-group">
                    <label>ä¿®æ”¹ä¸º:</label>
                    <div class="status-buttons" style="flex-wrap: wrap; gap: 10px;">
                        <!-- Buttons will have data-new-status attribute -->
                        <button data-new-status="å¾…å—ç†">è®¾ä¸º å¾…å—ç†</button> 
                        <button data-new-status="å¤„ç†ä¸­">è®¾ä¸º å¤„ç†ä¸­</button> 
                        <button data-new-status="å·²å®Œæˆ">è®¾ä¸º å·²å®Œæˆ</button> 
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="cancel-button" id="cancel-change-wo-status">å–æ¶ˆ</button>
                <!-- Confirmation is done via status buttons directly -->
            </div>
        </div>
    </div>

    <script src="script.js"></script> 
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const workOrderTypeSelect = document.getElementById('workOrderType');
            const workOrderStatusSelect = document.getElementById('workOrderStatus');
            const prioritySelect = document.getElementById('priority-select');
            const repairAreaSelect = document.getElementById('repair-area-select');
            const feeTypeSelect = document.getElementById('fee-type-select');
            const repairTable = document.querySelector('.repair-table');
            const paymentTable = document.querySelector('.payment-table');
            
            // å·¥å•ç±»å‹å˜æ›´æ—¶åˆ‡æ¢è¡¨æ ¼å’Œç›¸å…³ç­›é€‰é¡¹
            workOrderTypeSelect.addEventListener('change', function() {
                const selectedType = this.value;
                
                if (selectedType === 'payment') {
                    // æ˜¾ç¤ºç¼´è´¹å·¥å•è¡¨æ ¼å’Œç›¸å…³ç­›é€‰æ¡ä»¶
                    repairTable.style.display = 'none';
                    paymentTable.style.display = 'table';
                    prioritySelect.style.display = 'none';
                    repairAreaSelect.style.display = 'none';
                    feeTypeSelect.style.display = 'inline-block';
                    
                    // æ›´æ–°çŠ¶æ€é€‰é¡¹ä¸ºç¼´è´¹ç›¸å…³çŠ¶æ€
                    updateStatusOptions('payment');
                } else {
                    // é»˜è®¤æ˜¾ç¤ºç»´ä¿®å·¥å•è¡¨æ ¼å’Œç›¸å…³ç­›é€‰æ¡ä»¶
                    repairTable.style.display = 'table';
                    paymentTable.style.display = 'none';
                    prioritySelect.style.display = 'inline-block';
                    repairAreaSelect.style.display = 'inline-block';
                    feeTypeSelect.style.display = 'none';
                    
                    // æ›´æ–°çŠ¶æ€é€‰é¡¹ä¸ºç»´ä¿®ç›¸å…³çŠ¶æ€
                    updateStatusOptions('repair');
                }
            });
            
            // æ›´æ–°çŠ¶æ€é€‰é¡¹
            function updateStatusOptions(type) {
                // æ¸…ç©ºå½“å‰é€‰é¡¹
                workOrderStatusSelect.innerHTML = '<option value="">å·¥å•çŠ¶æ€</option>';
                
                if (type === 'payment') {
                    // ç¼´è´¹ç›¸å…³çŠ¶æ€
                    const paymentStatuses = [
                        { value: 'unpaid', text: 'å¾…ç¼´è´¹' },
                        { value: 'paid', text: 'å·²ç¼´è´¹' },
                        { value: 'reminded', text: 'å·²å‚¬ç¼´' },
                        { value: 'canceled', text: 'å·²å–æ¶ˆ' }
                    ];
                    
                    paymentStatuses.forEach(status => {
                        const option = document.createElement('option');
                        option.value = status.value;
                        option.textContent = status.text;
                        workOrderStatusSelect.appendChild(option);
                    });
                } else {
                    // ç»´ä¿®ç›¸å…³çŠ¶æ€
                    const repairStatuses = [
                        { value: 'pending', text: 'å¾…å¤„ç†' },
                        { value: 'processing', text: 'å¤„ç†ä¸­' },
                        { value: 'completed', text: 'å·²å®Œæˆ' }
                    ];
                    
                    repairStatuses.forEach(status => {
                        const option = document.createElement('option');
                        option.value = status.value;
                        option.textContent = status.text;
                        workOrderStatusSelect.appendChild(option);
                    });
                }
            }
            
            // åˆå§‹åŒ–ç¼´è´¹è¡¨æ ¼ç¤ºä¾‹æ•°æ®ï¼ˆç”¨äºæ¼”ç¤ºï¼‰
            function populatePaymentTableExample() {
                const paymentTableBody = paymentTable.querySelector('tbody');
                paymentTableBody.innerHTML = '';
                
                const sampleData = [
                    { status: 'å¾…ç¼´è´¹', type: 'æ°´ç”µè´¹', id: 'XXXXXXXX', detail: 'XXXXXXXXXX', period: 'XæœˆXæ—¥-XæœˆXæ—¥', amount: 'XXXå…ƒ', time: 'YYYY-MM-DD HH:MM' },
                    { status: 'å·²ç¼´è´¹', type: 'ç‰©ä¸šè´¹', id: 'XXXXXXXX', detail: 'XXXXXXXXXX', period: 'XæœˆXæ—¥-XæœˆXæ—¥', amount: 'XXXå…ƒ', time: 'YYYY-MM-DD HH:MM' },
                    { status: 'å·²å‚¬ç¼´', type: 'æ°´ç”µè´¹', id: 'XXXXXXXX', detail: 'XXXXXXXXXX', period: 'XæœˆXæ—¥-XæœˆXæ—¥', amount: 'XXXå…ƒ', time: 'YYYY-MM-DD HH:MM' }
                ];
                
                sampleData.forEach(item => {
                    let statusClass = '';
                    if (item.status === 'å¾…ç¼´è´¹') statusClass = 'status-pending';
                    else if (item.status === 'å·²ç¼´è´¹') statusClass = 'status-approved';
                    else if (item.status === 'å·²å‚¬ç¼´') statusClass = 'status-processing';
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><input type="checkbox" class="payment-order-checkbox"></td>
                        <td><span class="status-badge ${statusClass}">${item.status}</span></td>
                        <td>${item.type}</td>
                        <td>${item.id}</td>
                        <td>${item.detail}</td>
                        <td>${item.period}</td>
                        <td>${item.amount}</td>
                        <td>${item.time}</td>
                    `;
                    paymentTableBody.appendChild(row);
                });
            }
            
            // æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.querySelector('.search-button').addEventListener('click', function() {
                const selectedType = workOrderTypeSelect.value;
                
                if (selectedType === 'payment') {
                    // æ¨¡æ‹Ÿç¼´è´¹æŸ¥è¯¢
                    populatePaymentTableExample();
                } else {
                    // ç»´ä¿®æŸ¥è¯¢é€šè¿‡script.jsä¸­çš„å‡½æ•°å¤„ç†
                    // è¿™é‡Œä¸éœ€è¦é¢å¤–ä»£ç ï¼Œå› ä¸ºscript.jsä¸­å·²æœ‰ç›¸å…³é€»è¾‘
                }
            });
        });
    </script>
</body>
</html> 